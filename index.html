<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulador de Biocombustibles</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    margin: 0;
    background: #0a0a0e;
    font-family: "Montserrat", sans-serif;
    color: #ffffff;
}

header {
    padding: 35px;
    text-align: center;
    background: rgba(255,255,255,0.05);
    backdrop-filter: blur(12px);
}

.container {
    max-width: 1100px;
    margin: auto;
    padding: 20px;
}

.card {
    background: rgba(255,255,255,0.08);
    padding: 25px;
    border-radius: 18px;
    margin-bottom: 30px;
    backdrop-filter: blur(10px);
}

label {
    font-weight: 600;
}

input, select {
    width: 100%;
    padding: 10px;
    margin-top: 7px;
    border-radius: 10px;
    border: none;
}

.result-box {
    margin-top: 15px;
    padding: 15px;
    background: rgba(255,255,255,0.06);
    border-radius: 12px;
}

.illustration {
    width: 100%;
    border-radius: 15px;
    margin-bottom: 15px;
}

/* Animación del tanque */
#blendCanvas {
    width: 100% !important;
    height: auto !important;
    background: #111;
    border-radius: 12px;
}
</style>
</head>

<body>

<header>
    <h1>Simulador Avanzado de Biocombustibles</h1>
    <p>Calcula reducción de emisiones, mezcla y producción estimada</p>
</header>

<div class="container">

    <div class="card">
        <img class="illustration" src="https://i.imgur.com/Y3gbFJj.jpeg">

        <h2>Mezcla de Biocombustibles (Blend)</h2>
        <label>Seleccionar tipo de combustible base:</label>
        <select id="fuelType">
            <option value="diesel">Diésel</option>
            <option value="nafta">Nafta</option>
        </select>

        <label>Porcentaje de Biocombustible (Blend %):</label>
        <input type="range" min="0" max="100" value="20" id="blendSlider">

        <p><b>Blend actual:</b> <span id="blendValue">20%</span></p>

        <canvas id="blendCanvas"></canvas>

        <div class="result-box">
            <p><b>Reducción estimada de CO₂:</b> <span id="co2Reduction">0</span> %</p>
        </div>

        <div class="result-box">
            <p><b>Litros consumidos mensuales (estimado):</b> <span id="litrosMes">450</span> L</p>
            <p><b>CO₂ evitado al mes:</b> <span id="co2Mes">0</span> kg</p>
            <p><b>CO₂ evitado al año:</b> <span id="co2Anual">0</span> kg</p>
        </div>
    </div>

    <div class="card">
        <h2>Producción Estimada / Mezcla A lo Largo del Año</h2>
        <canvas id="biomassChart"></canvas>
    </div>

</div>

<script>
//---------------------------
// Animación del tanque
//---------------------------
const blendCanvas = document.getElementById("blendCanvas");
const btx = blendCanvas.getContext("2d");
blendCanvas.width = 600;
blendCanvas.height = 260;

let animT = 0;

function drawBlend(blend) {
    btx.fillStyle = "#000";
    btx.fillRect(0, 0, blendCanvas.width, blendCanvas.height);

    // Nivel del líquido (biocombustible)
    let h = (blend / 100) * blendCanvas.height;

    // Combustible fósil (base)
    btx.fillStyle = "#444";
    btx.fillRect(0, 0, blendCanvas.width, blendCanvas.height - h);

    // Biocombustible - animado
    for (let x = 0; x < blendCanvas.width; x++) {
        let yWave = Math.sin((x + animT) * 0.05) * 4;
        btx.fillStyle = "#4caf50";
        btx.fillRect(x, blendCanvas.height - h + yWave, 1, h);
    }

    animT += 1;
    requestAnimationFrame(() => drawBlend(blend));
}

//-------------------------------------
// Cálculos de emisiones
//-------------------------------------
function calcularReduccion(fuelType, blend) {
    // Valores típicos de reducción por blend
    const base = fuelType === "diesel" ? 2.68 : 2.31; // kg CO₂ / litro
    const reduccionPorcentaje = blend * 0.8; // 80% del blend es reducción válida

    return {
        reduccionPorcentaje,
        co2Mes: 450 * (base * (reduccionPorcentaje / 100)),
        co2Anual: 12 * 450 * (base * (reduccionPorcentaje / 100))
    };
}

//-------------------------------------
// Gráfico
//-------------------------------------
let ctx = document.getElementById("biomassChart");
let biomassChart = new Chart(ctx, {
    type: "bar",
    data: {
        labels: ["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],
        datasets: [{
            label: "CO₂ evitado (kg)",
            backgroundColor: "#4caf50aa",
            data: Array.from({length:12}, ()=>Math.random()*50+20)
        }]
    }
});

//-------------------------------------
// Eventos
//-------------------------------------
document.getElementById("blendSlider").addEventListener("input", actualizar);
document.getElementById("fuelType").addEventListener("change", actualizar);

function actualizar() {
    let blend = Number(document.getElementById("blendSlider").value);
    let fuelType = document.getElementById("fuelType").value;

    document.getElementById("blendValue").innerText = blend + "%";

    let r = calcularReduccion(fuelType, blend);

    document.getElementById("co2Reduction").innerText = r.reduccionPorcentaje.toFixed(1);
    document.getElementById("co2Mes").innerText = r.co2Mes.toFixed(1);
    document.getElementById("co2Anual").innerText = r.co2Anual.toFixed(1);

    // actualizar gráfico
    biomassChart.data.datasets[0].data = Array.from({length:12}, ()=>r.co2Mes * (0.6 + Math.random()*0.8));
    biomassChart.update();
}

// Inicialización
actualizar();
drawBlend(20);
</script>

</body>
</html>
