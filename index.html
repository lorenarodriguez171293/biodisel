<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title>App – Simulador de Biocombustibles</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    margin: 0;
    font-family: "Montserrat", sans-serif;
    background: #0a0a0e;
    color: #fff;
}

header {
    padding: 25px;
    text-align: center;
    background: rgba(255,255,255,0.05);
    backdrop-filter: blur(10px);
}

.app-container {
    padding: 18px;
    max-width: 450px;
    margin: auto;
}

.card {
    background: rgba(255,255,255,0.09);
    padding: 18px;
    border-radius: 20px;
    margin-bottom: 24px;
    backdrop-filter: blur(12px);
}

label {
    font-weight: 600;
    font-size: 0.95em;
}

select, input[type=range] {
    width: 100%;
    margin-top: 8px;
    border: none;
    border-radius: 12px;
    padding: 10px;
}

.result-box {
    margin-top: 18px;
    padding: 15px;
    background: rgba(255,255,255,0.07);
    border-radius: 15px;
}

.animation-box {
    width: 100%;
    height: 220px;
    position: relative;
    margin: 15px 0;
    background: #111;
    border-radius: 18px;
    overflow: hidden;
}

/* IMÁGENES */
.obj {
    position: absolute;
    bottom: 10px;
}

.soja {
    left: 10px;
    width: 85px;
    animation: grow 4s infinite alternate ease-in-out;
}

.petroleo {
    right: 10px;
    width: 70px;
    animation: pulse 3.5s infinite ease-in-out;
}

.blend-ball {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 95px;
    height: 95px;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: linear-gradient(45deg, #4caf50, #666);
    animation: morph 5s infinite ease-in-out;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 20px;
}

/* Animaciones */
@keyframes grow {
    from { transform: scale(0.9); }
    to   { transform: scale(1.1); }
}

@keyframes pulse {
    0%  { transform: scale(1); opacity: .8; }
    50% { transform: scale(1.1); opacity: 1; }
    100%{ transform: scale(1); opacity: .8; }
}

@keyframes morph {
    0% { border-radius: 45%; }
    50% { border-radius: 55%; }
    100% { border-radius: 45%; }
}
</style>
</head>

<body>

<header>
    <h1>App – Biocombustibles</h1>
    <p>Blend, emisiones y análisis mensual</p>
</header>

<div class="app-container">

    <!-- SIMULADOR PRINCIPAL -->
    <div class="card">

        <h2>Blend de Biocombustible</h2>

        <!-- Animación -->
        <div class="animation-box">
            <img src="https://i.imgur.com/8jy9uIg.png" class="obj soja">
            <img src="https://i.imgur.com/1Djhx0C.png" class="obj petroleo">
            <div class="blend-ball" id="blendBall">20%</div>
        </div>

        <label>Tipo de combustible fósil</label>
        <select id="fuelType">
            <option value="diesel">Diésel</option>
            <option value="nafta">Nafta</option>
        </select>

        <label>Porcentaje de biocombustible (Blend %)</label>
        <input type="range" min="0" max="100" value="20" id="blendSlider">

        <div class="result-box">
            <p><b>Reducción estimada de CO₂:</b> <span id="co2Reduction">0</span> %</p>
        </div>

        <div class="result-box">
            <p><b>Consumo mensual estimado:</b> <span id="litrosMes">450</span> L</p>
            <p><b>CO₂ evitado al mes:</b> <span id="co2Mes">0</span> kg</p>
            <p><b>CO₂ evitado al año:</b> <span id="co2Anual">0</span> kg</p>
        </div>

    </div>

    <!-- GRAFICO -->
    <div class="card">
        <h2>CO₂ evitado por mes</h2>
        <canvas id="biomassChart"></canvas>
    </div>

</div>

<script>
//---------------------------------------
// ANIMACIÓN BLEND – cambia color según %
//---------------------------------------
function updateBlendBall(percent) {
    const ball = document.getElementById("blendBall");
    ball.innerText = percent + "%";

    // Gradiente dinámico (más verde cuanto mayor es el blend)
    const greenLevel = percent / 100;
    const grayLevel = 1 - greenLevel;

    ball.style.background = `linear-gradient(45deg,
        rgba(76,175,80, ${greenLevel}),
        rgba(100,100,100, ${grayLevel})
    )`;
}

//---------------------------------------
// CÁLCULO DE EMISIONES
//---------------------------------------
function calcularReduccion(fuelType, blend) {
    const base = fuelType === "diesel" ? 2.68 : 2.31; // kg CO₂ por litro
    const reduccionPorcentaje = blend * 0.8; // reducción efectiva 80%

    return {
        reduccionPorcentaje,
        co2Mes: 450 * (base * (reduccionPorcentaje / 100)),
        co2Anual: 12 * 450 * (base * (reduccionPorcentaje / 100))
    };
}

//---------------------------------------
// GRAFICO
//---------------------------------------
let ctx = document.getElementById("biomassChart");
let biomassChart = new Chart(ctx, {
    type: "line",
    data: {
        labels: ["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],
        datasets: [{
            label: "CO₂ evitado (kg)",
            backgroundColor: "#4caf5090",
            borderColor: "#4caf50",
            data: Array.from({length:12}, ()=>Math.random()*50+20),
            tension: 0.4
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: { beginAtZero: true }
        }
    }
});

//---------------------------------------
// EVENTOS DE LA APP
//---------------------------------------
document.getElementById("blendSlider").addEventListener("input", actualizar);
document.getElementById("fuelType").addEventListener("change", actualizar);

function actualizar() {
    let blend = Number(document.getElementById("blendSlider").value);
    let fuelType = document.getElementById("fuelType").value;

    updateBlendBall(blend);

    let r = calcularReduccion(fuelType, blend);

    document.getElementById("co2Reduction").innerText = r.reduccionPorcentaje.toFixed(1);
    document.getElementById("co2Mes").innerText = r.co2Mes.toFixed(1);
    document.getElementById("co2Anual").innerText = r.co2Anual.toFixed(1);

    // Actualizar gráfico
    biomassChart.data.datasets[0].data =
        Array.from({ length: 12 }, () => r.co2Mes * (0.7 + Math.random() * 0.6));

    biomassChart.update();
}

// Inicializar visualmente
actualizar();
</script>

</body>
</html>
